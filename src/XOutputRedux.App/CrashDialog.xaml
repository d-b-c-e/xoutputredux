<Window x:Class="XOutputRedux.App.CrashDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="XOutputRedux - Application Error"
        Height="500" Width="650"
        MinHeight="400" MinWidth="500"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip"
        Background="#1E1E1E"
        ShowInTaskbar="True">

    <Window.Resources>
        <!-- Dark Theme Colors -->
        <SolidColorBrush x:Key="BackgroundBrush" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="BackgroundSecondaryBrush" Color="#252526"/>
        <SolidColorBrush x:Key="ControlBackgroundBrush" Color="#2D2D30"/>
        <SolidColorBrush x:Key="ControlHoverBrush" Color="#3E3E42"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#3F3F46"/>
        <SolidColorBrush x:Key="ForegroundBrush" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="ForegroundDimBrush" Color="#9E9E9E"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#F44336"/>
        <SolidColorBrush x:Key="AccentGreenBrush" Color="#4CAF50"/>

        <!-- Button Style -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="MinWidth" Value="110"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1" CornerRadius="3"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource ControlHoverBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Green Button Style -->
        <Style x:Key="GreenButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource AccentGreenBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource AccentGreenBrush}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with error icon -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="&#xE7BA;" FontFamily="Segoe MDL2 Assets" FontSize="32"
                       Foreground="{StaticResource ErrorBrush}" VerticalAlignment="Center" Margin="0,0,15,0"/>
            <StackPanel VerticalAlignment="Center">
                <TextBlock Text="An error occurred in XOutputRedux"
                           FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource ForegroundBrush}"/>
                <TextBlock x:Name="ContextText" Text="Context: UI Thread"
                           FontSize="12" Foreground="{StaticResource ForegroundDimBrush}" Margin="0,4,0,0"/>
            </StackPanel>
        </StackPanel>

        <!-- Error summary box -->
        <Border Grid.Row="1" Background="{StaticResource ControlBackgroundBrush}" CornerRadius="4"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="12" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock x:Name="ExceptionTypeText" Text="NullReferenceException"
                           FontFamily="Consolas" FontSize="14" Foreground="{StaticResource ErrorBrush}" FontWeight="Bold"/>
                <TextBlock x:Name="MessageText" Text="Object reference not set to an instance of an object"
                           FontSize="12" Foreground="{StaticResource ForegroundBrush}" TextWrapping="Wrap" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Stack trace viewer -->
        <Border Grid.Row="2" Background="{StaticResource BackgroundSecondaryBrush}" CornerRadius="4"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                <TextBox x:Name="StackTraceText"
                         IsReadOnly="True"
                         Background="Transparent"
                         Foreground="{StaticResource ForegroundDimBrush}"
                         BorderThickness="0"
                         FontFamily="Consolas"
                         FontSize="11"
                         TextWrapping="NoWrap"
                         Padding="10"/>
            </ScrollViewer>
        </Border>

        <!-- Help text -->
        <TextBlock Grid.Row="3" Margin="0,15,0,15"
                   Foreground="{StaticResource ForegroundDimBrush}" FontSize="11" TextWrapping="Wrap">
            <Run Text="You can help improve XOutputRedux by reporting this error on GitHub."/>
            <LineBreak/>
            <Run Text="The crash report includes technical details but no personal information."/>
        </TextBlock>

        <!-- Action buttons -->
        <Grid Grid.Row="4">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                <Button x:Name="CopyButton" Content="Copy to Clipboard" Click="CopyButton_Click"/>
                <Button x:Name="ViewLogButton" Content="View Log File" Margin="10,0,0,0" Click="ViewLogButton_Click"/>
                <Button x:Name="ReportButton" Content="Report on GitHub" Margin="10,0,0,0"
                        Style="{StaticResource GreenButtonStyle}" Click="ReportButton_Click"/>
            </StackPanel>

            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="ContinueButton" Content="Continue" Click="ContinueButton_Click" Visibility="Collapsed"/>
                <Button x:Name="ExitButton" Content="Exit Application" Margin="10,0,0,0" Click="ExitButton_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
